<?php

/*
 * Localization addon for Bear Framework
 * https://github.com/bearframework/localization-addon
 * Copyright (c) Ivo Petkov
 * Free to use under the MIT license.
 */

return <<<'EOT'
var f=function(e,a){var t=GET_TEXT_FUNCTION_TO_REPLACE,o=LOCALE_TO_REPLACE,r=function(e,a){return e.replace("%s",a)},n=new Date(e),i=new Date,h=Math.floor(n.getTime()/1e3),m=Math.floor(i.getTime()/1e3);void 0===a&&(a=["dateAutoYear"]);var l,g={},u=function(e){return-1!==a.indexOf(e)},f=u("date"),d=u("dateAutoYear"),y=u("month"),D=u("monthShort"),s=u("year"),w=u("autoYear"),k=u("monthDay"),c=u("weekDay"),b=u("weekDayShort"),v=u("weekNumber"),_=u("time");if(u("timeAgo")){var p=m-h;if(p<60)g.timeAgo=t("bearframework-localization-addon.moment_ago");else if(p<3600){var A=Math.floor(p/60);g.timeAgo=A>1?r(t("bearframework-localization-addon.minutesAgo_ago"),A):t("bearframework-localization-addon.minute_ago")}else if(p<86400){var T=Math.floor(p/3600);g.timeAgo=T>1?r(t("bearframework-localization-addon.hours_ago"),T):t("bearframework-localization-addon.hour_ago")}else d=!0}if((f||d||k)&&(g.monthDay=n.getDate()),(f||d||y)&&(g.month=t("bearframework-localization-addon.month_"+(n.getMonth()+1))),D&&(g.month=t("bearframework-localization-addon.month_"+(n.getMonth()+1)+"_short")),f||s||d||w){var z=n.getFullYear();(d||w)&&z===i.getFullYear()||("bg"===o&&(z+="г."),g.year=z)}c&&(0===(l=n.getDay())&&(l=7),g.weekDay=t("bearframework-localization-addon.day_"+l));b&&(0===(l=n.getDay())&&(l=7),g.weekDay=t("bearframework-localization-addon.day_"+l+"_short"));if(v){var M=new Date(n);M.setHours(0,0,0,0),M.setDate(M.getDate()+3-(M.getDay()+6)%7);var O=new Date(M.getFullYear(),0,4);g.weekNumber=(1+Math.round(((M.getTime()-O.getTime())/864e5-3+(O.getDay()+6)%7)/7)).toString()}_&&(g.time="bg"===o?n.getHours()+":"+n.getMinutes().toString().padStart(2,"0")+"ч.":n.getHours()+":"+n.getMinutes().toString().padStart(2,"0"));var E=[];-1!==["bg","ru"].indexOf(o)?(E.push("{weekDay}, {monthDay} {month} {year}"),E.push("{weekDay}, {monthDay} {month}"),E.push("{monthDay} {month} {year}"),E.push("{monthDay} {month}")):(E.push("{weekDay}, {month} {monthDay}, {year}"),E.push("{weekDay}, {month} {monthDay}"),E.push("{month} {monthDay}, {year}"),E.push("{month} {monthDay}"));for(var S="",Y=Object.keys(g),C=0;C<E.length;C++){var F=E[C],L=F.match(/\{.*?\}/g);if(null!==L&&L.length>0){var N=L.map((function(e){return e.replace(/{|}/g,"")}));if(N.filter((function(e){return-1!==Y.indexOf(e)})).length===N.length){S=F;for(var j=0;j<N.length;j++)S=S.replace("{"+N[j]+"}",g[N[j]]),delete g[N[j]];break}}}var x=Object.values(g);return x.length>0&&(""!==S&&(S+=","),S+=" "+x.join(", ")),S};
EOT;
